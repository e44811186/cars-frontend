<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <title>Car Rent</title>
    <base href="/" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <style>
      .container { max-width: 1200px; margin: 0 auto; }
      .button {
        width: 344px; height: 69px; padding: 20px; text-align: center;
        box-sizing: border-box; background-color: #f8ff23; color: #000;
        outline: 0; text-decoration: none; display: block; border: 0; cursor: pointer; font-size: 24px;
      }
      .button:hover:not(:disabled) { background-color: #ffffff; }
      .button:disabled { cursor: not-allowed; color: gray; background-color: #343434; }
      .button.white-button { background-color: #ffffff; }
      .button.white-button:hover { background-color: #f8ff23; }
      .main { overflow: hidden; position: relative; }
      .black-block { position: absolute; width: 477px; height: 910px; top: 0; background-color: #000000; z-index: -2; right: calc(50% - 780px); }
      .header { padding: 46px 0; }
      .header .container { display: flex; align-items: center; }
      .logo img { max-width: 129px; vertical-align: bottom; }
      .menu { margin-left: 177px; margin-right: auto; }
      .menu ul { list-style: none; display: flex; gap: 65px; }
      .menu ul a { font-size: 14px; color: #a8ae16; font-weight: bold; text-decoration: none; cursor: pointer; text-transform: uppercase; }
      .menu ul a:hover { color: #f8ff23; }
      .phone { font-size: 14px; font-weight: bold; color: #ffffff; text-decoration: none; cursor: pointer; letter-spacing: normal; }
      .main-content { padding-top: 100px; padding-bottom: 175px; }
      .main-content .container { position: relative; }
      .main-info { max-width: 755px; }
      .main-info h1 { font-size: 80px; line-height: 100%; margin-bottom: 40px; font-weight: normal; }
      .main-info p { font-size: 24px; line-height: 120%; color: #d4d4d4; max-width: 440px; margin-bottom: 60px; }
      .main-image { position: absolute; top: 78px; right: -576px; z-index: -1; }
      .cars { background-color: #000000; padding: 130px 0; }
      .cars h2 { font-size: 65px; font-weight: normal; }
      .cars-content { display: flex; padding-top: 60px; }
      .cars-filter { margin-right: 77px; align-self: flex-start; position: sticky; top: 20px; }
      .cars-filter ul { display: flex; flex-direction: column; row-gap: 15px; list-style: none; }
      .cars-filter ul li {
        width: 127px; padding: 16px; text-align: center; border: 1px solid white; font-size: 16px; color: #ffffff;
        box-sizing: border-box; cursor: pointer; outline: none;
      }
      .cars-filter ul li.active, .cars-filter ul li:hover { color: #f8ff23; border-color: #f8ff23; }
      .cars-items { display: flex; flex-direction: column; row-gap: 30px; }
      .car { background-color: #212121; padding: 20px; display: flex; }
      .car img { max-width: 568px; }
      .car-details { margin-left: 24px; display: flex; flex-direction: column; }
      .car-details h4 { font-size: 30px; line-height: 120%; margin-bottom: 20px; }
      .car-details p { font-size: 16px; line-height: 120%; letter-spacing: normal; color: #d4d4d4; height: 100px; }
      .car-action { margin-top: auto; }
      .car-action ul { list-style: none; display: flex; justify-content: space-between; margin-bottom: 20px; }
      .car-period { font-size: 16px; line-height: 120%; color: #d4d4d4; margin-bottom: 5px; }
      .car-price { font-size: 24px; line-height: 120%; }
      .car-price span { font-size: 16px; line-height: 120%; color: #d4d4d4; }
      .car-action .button { width: 100%; }
      .order { padding-top: 150px; padding-bottom: 130px; }
      .order .container { position: relative; }
      .order img { position: absolute; top: -25px; left: -530px; }
      .order form { margin-left: 714px; max-width: 486px; }
      .order h3 { font-weight: normal; font-size: 65px; line-height: 100%; margin-bottom: 40px; }
      .order p { font-size: 24px; line-height: 120%; color: #d4d4d4; margin-bottom: 60px; max-width: 455px; }
      .order-form { width: 344px; }
      ::placeholder { color: #d4d4d4; }
      .order-form input {
        width: 100%; height: 68px; padding: 24px 20px; box-sizing: border-box; color: #ffffff;
        border: 1px solid #ffffff; background-color: transparent; margin-bottom: 15px; font-size: 16px; outline: none;
      }
      .order-form input.error { border-color: red; }

      html { scroll-behavior: smooth; }
      body { background-color: #212121; font-family: Helvetica, sans-serif; letter-spacing: -1px; color: #fff; }
    </style>
  </head>
  <body>
    <main class="main">
      <header class="header">
        <div class="container">
          <div class="logo"><img src="images/logo.png" alt="Logo" /></div>
          <nav class="menu">
            <ul>
              <li><a href="#cars">НАШ автопарк</a></li>
              <li><a href="#order">Забронировать</a></li>
            </ul>
          </nav>
          <a href="tel:+971523898989" class="phone">+971 52 389 89 89</a>
        </div>
      </header>

      <section class="main-content">
        <div class="container">
          <div class="main-info">
            <h1>Покорите дороги за рулём легендарных автомобилей!</h1>
            <p>От эксклюзивных спорткаров до гоночных шедевров — выбирайте мечту,
              садитесь за руль и ощутите мощь премиального авто на полную!</p>
            <a href="#cars" class="button">Посмотреть автомобили</a>
          </div>
          <img src="images/main-car.png" alt="main car" class="main-image" />
        </div>
      </section>
      <div class="black-block"></div>
    </main>

    <section class="cars" id="cars">
      <div class="container">
        <h2>Выберите автомобиль</h2>
        <div class="cars-content" id="cars-content">
          <aside class="cars-filter">
            <ul id="brands-list"></ul>
          </aside>

          <div class="cars-items" id="cars-list"></div>
        </div>
      </div>
    </section>

    <section class="order" id="order">
      <div class="container">
        <img src="images/order-car.png" alt="order car" />
        <form id="orderForm">
          <h3>Забронируйте автомобиль</h3>
          <p>Заполните контактные данные, и мы перезвоним вам для обсуждения деталей и подтверждения бронирования</p>
          <div class="order-form">
            <input type="text" placeholder="Автомобиль" required readonly id="car" />
            <input type="text" placeholder="Ваше имя" required id="name" />
            <input type="text" placeholder="Ваш телефон" required minlength="10" id="phone" />
            <button class="button" type="submit" id="order-action">Забронировать</button>
          </div>
        </form>
      </div>
    </section>

    <footer class="footer">
      <div class="container" style="padding:47px 0; border-top:1px solid #5f5f5f; display:flex; justify-content:space-between; align-items:center;">
        <div class="logo"><img src="images/logo.png" alt="Logo" /></div>
        <div class="rights" style="font-size:14px; line-height:90%; letter-spacing:normal; font-weight:bold; text-transform:uppercase;">Все права защищены</div>
      </div>
    </footer>

    <script>
      const API_BASE = "https://cars-api-ur5t.onrender.com/api/cars";
      let allCars = [];


      function buildPrices(base) {
        const day1 = Math.round(base);
        const day1to3 = Math.round(base * 0.95);
        const day3plus = Math.round(base * 0.90);
        return [day1, day1to3, day3plus];
      }

      function createCarArticle(car) {
        const prices = buildPrices(car.price);
        const article = document.createElement('article');
        article.className = 'car';
        article.innerHTML = `
          <img src="${car.imageUrl}" alt="car" />
          <div class="car-details">
            <h4>${car.brand} ${car.model} (${car.year})</h4>
            <p>${car.description}</p>
            <div class="car-action">
              <ul>
                ${["на 1 сутки","на 1-3 суток","на 3+ суток"].map((p,i)=>`
                  <li>
                    <div class="car-period">${p}</div>
                    <div class="car-price">${prices[i]} $ ${i>0?'<span>/сут</span>':''}</div>
                  </li>
                `).join('')}
              </ul>
              <a href="#order" class="button white-button" data-title="${car.brand} ${car.model}">Забронировать</a>
            </div>
          </div>
        `;

        const btn = article.querySelector('a.button.white-button');
        btn.addEventListener('click', (e) => {
          document.getElementById('car').value = btn.getAttribute('data-title');
        });
        return article;
      }

      function renderCars(cars) {
        const list = document.getElementById('cars-list');
        list.innerHTML = '';
        cars.forEach(c => list.appendChild(createCarArticle(c)));
      }

      function renderBrands() {
        const box = document.getElementById('brands-list');
        box.innerHTML = '';
        const uniq = Array.from(new Set(allCars.map(c => c.brand)));
        const makeLi = (name, active=false) => {
          const li = document.createElement('li');
          li.textContent = name;
          if (active) li.classList.add('active');
          li.addEventListener('click', () => {
            [...box.children].forEach(el => el.classList.remove('active'));
            li.classList.add('active');
            if (name === 'Все марки') renderCars(allCars);
            else renderCars(allCars.filter(c => c.brand === name));
            document.getElementById('cars-content').scrollIntoView({behavior:'instant'});
          });
          return li;
        };
        box.appendChild(makeLi('Все марки', true));
        uniq.forEach(b => box.appendChild(makeLi(b)));
      }

      async function loadCars() {
        try {
          const res = await fetch(API_BASE);
          allCars = await res.json();
          renderBrands();
          renderCars(allCars);
        } catch (err) {
          console.error('Ошибка загрузки:', err);
        }
      }

      document.getElementById('orderForm').addEventListener('submit', (e) => {
        e.preventDefault();
        const car = document.getElementById('car').value.trim();
        const name = document.getElementById('name').value.trim();
        const phone = document.getElementById('phone').value.trim();
        if (!car || !name || !phone) return;
        alert(`Заявка отправлена!\nАвто: ${car}\nИмя: ${name}\nТелефон: ${phone}`);
        e.target.reset();
      });

      loadCars();
    </script>
  </body>
</html>
